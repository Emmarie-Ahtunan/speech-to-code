(this["webpackJsonpspeech2code.webapp"]=this["webpackJsonpspeech2code.webapp"]||[]).push([[0],{120:function(e,n,t){},129:function(e,n,t){"use strict";(function(e){var a=t(58),r=t(59),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=i(t(130)),o=i(t(134)),s=i(t(135)),l=function(){function n(e){a(this,n),this.modules=[],this.modules=e}return r(n,[{key:"newModule",value:function(e){throw new Error("Method not implemented!")}},{key:"saveCommand",value:function(n,t,a){var r=this.modules.find((function(e){return e.name===n}));if(!r)throw new Error("Module not found");if(r.categories[t.name]||(r.categories[t.name]={desc:t.desc||"",commands:[]}),void 0==a.id)a.id=+new Date,r.categories[t.name].commands.push(a);else{var i=r.categories[t.name].commands.findIndex((function(e){return e.id===a.id}));r.categories[t.name].commands[i]=a}o.default.writeFileSync(s.default.resolve(e,"spoken1.yaml"),c.default.stringify(r),"utf-8")}},{key:"removeCommand",value:function(e,n,t){}},{key:"listCommands",value:function(){return this.modules}}]),n}();n.default=l}).call(this,"/")},136:function(e,n){n.default={name:"Spoken",desc:"Spoken is language designed to be able to control a text editor by using voice commands.",categories:{line:{desc:"Things related to line manipulation",commands:[{id:0,desc:"Moves the cursor to a different line.",phrases:{en:["go to line {number:numeral}","line {number:numeral}"],pt_br:["v\xe1 para linha {number:numeral}","linha {number:numeral}"]},impl:"async function goToLine(command, editor, context) {\n  // yara yara do something\n  return await editor.goToLine(command.number)\n}\n"},{id:1,desc:"Creates a new line below the current line.",phrases:{en:["new line below","create a new line below","new line","create a new line"],pt_br:["linha nova abaixo","crie uma linha nova abaixo","linha nova","crie uma linha nova"]},impl:"async function newLineBelow(command, editor, context) {\n  return await editor.newLine()\n}\n"},{id:2,desc:"Creates a new line above the current line.",phrases:{en:["new line above","create a new line above"],pt_br:["linha nova acima","crie uma linha nova acima"]},impl:"function newLineAbove(command, editor, context) {\n  // yara yara something\n}\n"},{id:3,desc:"Removes the specified line. If none was provided the current line will be removed.",phrases:{en:["remove line {numeral}","remove the line {numeral}"],pt_br:["remova linha {numeral}","remova a linha {numeral}"]},impl:"function removeLine(command, editor, context) {\n  // yara yara something\n}\n"},{id:4,desc:"Selects the specifed term in the specified line, if no line was provided the current will be used.",phrases:{en:["select the {term} in the line {numeral}","select {term} on line {numeral}"],pt_br:["selecione o termo {term} na linha {numeral}","selecione {term} na linha {numeral}","na linha {numeral} selecione {term}"]},impl:"function selectTerm(command, editor, context) {\n  // yara yara something\n}\n"}]},write:{desc:"Things related to text input",commands:[{id:1024,desc:"Just write something.",phrases:{en:["write {text:any}","write the following term {text:any}"],pt_br:["escreva {text:any}","escreva o seguinte termo {text:any}"]},impl:"async function write(command, editor, context) {\n  console.log('[Spoken]: Executing:\\n\\t \"Write {term}\"')\n  return await editor.write(command.text)\n}\n"},{id:1025,desc:"Declares a constant or a variable.",phrases:{en:["declare a {memType:constant|variable} called {name:term}","declare a {memType:constant|variable} called {name:term} with value {value:term}","declare a {memType:constant|variable} called {name:term} of type {type:term}","declare a {memType:constant|variable} called {name:term} of type {type:term} with value {value:term}"],pt_br:["declare uma {memType:constante|vari\xe1vel} chamada {name:term}","declare uma {memType:constante|vari\xe1vel} chamada {name:term} com o valor {value:term}","declare uma {memType:constante|vari\xe1vel} chamada {name:term} do tipo {type:term}","declare uma {memType:constante|vari\xe1vel} chamada {name:term} do tipo {type:term} com o valor {value:term}","declaro uma {memType:constante|vari\xe1vel} chamada {name:term}","declaro uma {memType:constante|vari\xe1vel} chamada {name:term} com o valor {value:term}","declaro uma {memType:constante|vari\xe1vel} chamada {name:term} do tipo {type:term}","declaro uma {memType:constante|vari\xe1vel} chamada {name:term} do tipo {type:term} com o valor {value:term}","declaro uma {memType:constante|vari\xe1vel} chamada {name:term} com valor {value:term}","declaro uma {memType:constante|vari\xe1vel} chamada {name:term} do tipo {type:term} com valor {value:term}","declare uma {memType:constante|vari\xe1vel} chamada {name:term} com valor {value:term}","declare uma {memType:constante|vari\xe1vel} chamada {name:term} do tipo {type:term} com valor {value:term}"]},impl:"async function declareConst(c, editor, context) {\n  console.log('[Spoken]: Executing: \"Declare a variable.\"')\n  // const { text, lineNumber } = editor.getLine()\n  const memType = parseInt(c.memType || 0, 10) === 0 ? 'const ' : 'let '\n  const type = c.type ? `:${c.type}` : ''\n  const value = c.value ? ` = ${c.value}` : '' \n\n  const text = `${memType}${c.name}${type}${value}`\n\n  await editor.write(text)\n  return await editor.indentSelection([undefined, 0], [undefined, text.length])\n}\n"}]}}}},141:function(e,n,t){"use strict";t.r(n);var a,r=t(15),i=t.n(r),c=t(81),o=t.n(c),s=(t(120),t(25)),l=t(7);function u(){var e=Object(r.useState)(!1),n=Object(s.a)(e,2),t=n[0],a=n[1];return Object(l.jsxs)("header",{children:[Object(l.jsx)("div",{className:"menu",children:Object(l.jsx)("div",{className:"icon",onClick:function(){return a(!t)},children:"\u2630"})}),Object(l.jsxs)("div",{className:"menu-items ".concat(t?"open":""),children:[Object(l.jsxs)("div",{className:"about",children:[Object(l.jsx)("div",{className:"title",children:"Speech To Code"}),Object(l.jsx)("div",{className:"sub",children:"by Pedro Augusto"})]}),Object(l.jsx)("div",{className:"divider"}),Object(l.jsxs)("ul",{children:[Object(l.jsx)("li",{children:Object(l.jsx)("a",{href:"/#",onClick:function(){return a(!t)},children:"Home"})}),Object(l.jsx)("li",{children:Object(l.jsx)("a",{href:"/#/spoken",onClick:function(){return a(!t)},children:"Spoken"})})]})]}),Object(l.jsx)("div",{className:"menu-items-shade ".concat(t?"open":""),onClick:function(){return a(!t)}}),Object(l.jsx)("div",{className:"brand",children:Object(l.jsxs)("div",{className:"title",children:[">"," ./speech-to-code"]})})]})}var m={send:function(e){console.warn("IPC not defined (this is a electron application!)")},on:function(e,n){console.warn("IPC not defined (this is a electron application!)")}},d=(null===(a=window)||void 0===a?void 0:a.ipcRenderer)||m,h=t(51),p=t(1),v=t(3),f=t(2),j=t.n(f),b=t(43),g=t(154),x=t(148),O=t(153),y=t(155),w=t(46),_=t(82),k=t.n(_),C=function(){function e(){Object(p.a)(this,e),this.speechConfig=null,this.audioConfig=null,this.recognizer=null,this.handlers=new Map}return Object(v.a)(e,[{key:"init",value:function(){this.speechConfig=g.a.fromSubscription("PEDRO_AUG","brazilsouth"),this.speechConfig.speechRecognitionLanguage="pt-BR",this.speechConfig.setServiceProperty("punctuation","explicit",x.a.UriQueryParameter),this.audioConfig=O.a.fromDefaultMicrophoneInput(),this.recognizer=new y.a(this.speechConfig,this.audioConfig)}},{key:"start",value:function(){var e=this;if(null==this.recognizer)return console.error("[webapp.services.azure-voice-recognition]: Session is closed!");this.recognizer.recognizeOnceAsync((function(n){if(console.log("[webapp.services.azure-voice-recognition]: Results ",n),n.reason==w.a.RecognizedSpeech){var t=e.handlers.get("results");null!=t&&t(n)}else{var a=e.handlers.get("error");null!=a&&a({err:new Error("Something went wrong!"),result:n})}}),(function(n){console.log("[webapp.services.azure-voice-recognition]: Err "+n.toString());var t=e.handlers.get("error");null!=t&&t({err:new Error("Something went wrong!"),result:null})}))}},{key:"stop",value:function(){if(null==this.recognizer)return console.error("[webapp.services.azure-voice-recognition]: Session is closed!")}},{key:"destroy",value:function(){var e;null===(e=this.recognizer)||void 0===e||e.close(),this.recognizer=null,this.audioConfig=null,this.handlers.clear()}},{key:"on",value:function(e,n){return this.handlers.set(e,n),this}}],[{key:"getRecognizer",value:function(){return null==e.recognizer&&(e.recognizer=new e),e.recognizer}}]),e}();function S(e){console.log("[webapp.services.azure-voice-recognition] Warn: Ignoring other matches!");var n=e.text,t=k.a.matchPhrase(n,"pt_br");return{_rawVoiceToTextResponse:e,phrase:[n],command:t?Object(h.a)(Object(h.a)({},t.command),{},{commandArgs:t.commandArgs}):null}}C.recognizer=null;var N=function(){var e=Object(r.useState)(""),n=Object(s.a)(e,2),t=n[0],a=n[1],i=C.getRecognizer();return Object(r.useEffect)((function(){return console.log("[webapp.services.azure-voice-recognition]: Initialized"),i.on("results",(function(e){setTimeout((function(){return d.send("Spoken:analyze",S(e))}),1e3)})).on("error",(function(e){console.error("[webapp.services.azure-voice-recognition.onResultError]: Error",e.toString())})).init(),d.on("Spoken:analysisResults",(function(e){a(e.phrase)})),function(){i.destroy()}}),[]),{results:t,start:function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.start();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),stop:function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.stop();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),analyzeSentence:function(){var e=Object(b.a)(j.a.mark((function e(n){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={text:n},setTimeout((function(){return d.send("Spoken:analyze",S(t))}),3e3);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}};function T(){var e=Object(r.useState)(!1),n=Object(s.a)(e,2),t=n[0],a=n[1],i=Object(r.useState)([]),c=Object(s.a)(i,2),o=c[0],u=c[1],m=N(),h=m.results,p=m.start,v=m.stop,f=m.analyzeSentence;return Object(r.useEffect)((function(){d.on("VoiceRecognition:toggleRecording",(function(e){e?p():v(),a(e)})),d.on("Config:onChangeEditorState",(function(e){u(e)})),d.send("Config:changeEditor",null)}),[]),Object(l.jsxs)("main",{className:"main",children:[Object(l.jsxs)("div",{className:"editor-in-use",children:[Object(l.jsx)("div",{children:"Editors:"}),Object(l.jsx)("ul",{children:o.map((function(e){var n=e.name,t=(e.current?"selected ":"")+("ON"===e.status?"on":"");return Object(l.jsx)("li",{className:t,onClick:function(){return e=n,void d.send("Config:changeEditor",e);var e},children:n})}))})]}),Object(l.jsxs)("div",{className:"record ".concat(t?"on":"off"),children:[Object(l.jsx)("div",{className:"btn",onClick:function(){t?v():p(),a(!t)}}),Object(l.jsxs)("div",{className:"label",children:[Object(l.jsx)("b",{children:t?"Stop":"Start"})," recording"]})]}),Object(l.jsxs)("div",{className:"transcription",children:[Object(l.jsx)("label",{children:"Transcription:"}),Object(l.jsx)("div",{className:"transcription-text",children:h})]}),Object(l.jsxs)("div",{className:"debug",children:[Object(l.jsx)("label",{children:"Debug:"}),Object(l.jsx)("div",{className:"transcription-text input",contentEditable:!0}),Object(l.jsx)("button",{onClick:function(){var e,n=null===(e=document.querySelector(".transcription-text.input"))||void 0===e?void 0:e.innerText;setTimeout((function(){return f(n)}),4e3)},children:"Analyze"})]})]})}var z=function(e){if(e.ok)return e.json();var n=new Error("[Rest API Error] "+e.statusText);throw console.error(n),n},E=function(){return fetch("http://localhost:3000/spoken/list").then(z)};function I(){var e=Object(r.useState)([]),n=Object(s.a)(e,2),t=n[0],a=n[1],i=Object(r.useState)(null),c=Object(s.a)(i,2),o=c[0],u=c[1],m=Object(r.useState)(!1),d=Object(s.a)(m,2),h=d[0],p=d[1];return Object(r.useEffect)((function(){E().then((function(e){a(e)}))}),[]),Object(l.jsxs)("main",{className:"spoken",children:[Object(l.jsxs)("div",{className:"wrapper",children:[Object(l.jsx)("h2",{children:"Modules"}),t.map((function(e){return Object(l.jsxs)("div",{className:"module ".concat(h?"open":""),children:[Object(l.jsxs)("div",{className:"module__title",children:[e.name,Object(l.jsx)("span",{onClick:function(){return p(!h)},children:"\u276f"})]}),Object(l.jsx)("div",{className:"module__desc",children:e.desc}),Object(l.jsx)("div",{className:"module__commands",children:Object(l.jsx)("ul",{children:Object.values(e.categories).map((function(n){return n.commands.map((function(t){return Object(l.jsx)("li",{onClick:function(){return u({module:e,category:n,command:t})},children:t.desc})}))}))})})]})}))]}),null!==o&&Object(l.jsxs)("div",{className:"module__details",children:[Object(l.jsxs)("div",{className:"module__details__wrapper",children:[Object(l.jsxs)("div",{className:"module__main-header",children:[Object(l.jsx)("h2",{children:o.module.name}),Object(l.jsx)("span",{title:"close",onClick:function(){return u(null)},children:"\xd7"}),Object(l.jsx)("div",{children:o.module.desc})]}),Object(l.jsx)("div",{className:"divider"}),Object(l.jsxs)("div",{className:"module__main",children:[Object(l.jsx)("h4",{children:"Command:"}),Object(l.jsxs)("div",{className:"field",children:[Object(l.jsx)("div",{className:"label",children:"#ID:"}),Object(l.jsx)("input",{type:"text",readOnly:!0,className:"value",value:o.command.id})]}),Object(l.jsxs)("div",{className:"field desc",children:[Object(l.jsx)("div",{className:"label",children:"Description:"}),Object(l.jsx)("textarea",{children:o.command.desc})]}),Object(l.jsxs)("div",{className:"field impl",children:[Object(l.jsx)("div",{className:"label",children:"Implementation:"}),Object(l.jsx)("textarea",{children:o.command.impl})]}),Object(l.jsxs)("div",{className:"field phrases",children:[Object(l.jsx)("div",{className:"label",children:"Phrases:"}),Object(l.jsx)("ul",{className:"idioms",children:Object.entries(o.command.phrases).map((function(e){var n=Object(s.a)(e,2),t=n[0],a=n[1];return Object(l.jsxs)("li",{className:"idiom",children:[Object(l.jsx)("input",{type:"text",value:t,name:"lang"}),Object(l.jsx)("ul",{className:"commands",children:a.map((function(e){return Object(l.jsx)("li",{children:Object(l.jsx)("input",{type:"text",value:e,name:"phrase"})})}))})]})}))})]})]})]}),Object(l.jsxs)("div",{className:"module__footer",children:[Object(l.jsx)("button",{children:"Save"}),Object(l.jsx)("button",{children:"Remove"})]})]})]})}function R(e){return Object(l.jsxs)("div",{children:[Object(l.jsx)(u,{}),Object(l.jsx)(A,{pages:[{hash:"",component:T},{hash:"#/spoken",component:I}]})]})}function A(e){var n=Object(r.useState)(window.location.hash),t=Object(s.a)(n,2),a=t[0],i=t[1];Object(r.useEffect)((function(){function e(){i(window.location.hash)}return window.addEventListener("hashchange",e),function(){window.removeEventListener("hashchange",e)}}),[]);var c=e.pages.find((function(e){return e.hash===a}));return c?Object(l.jsx)(c.component,{}):null}o.a.render(Object(l.jsx)(i.a.StrictMode,{children:Object(l.jsx)(R,{})}),document.getElementById("root"))},33:function(e,n){},38:function(e,n){},82:function(module,exports,__webpack_require__){"use strict";var _slicedToArray=__webpack_require__(123),_createForOfIteratorHelper=__webpack_require__(128),_classCallCheck=__webpack_require__(58),_createClass=__webpack_require__(59),__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var modules_1=__importDefault(__webpack_require__(129)),spoken_1=__importDefault(__webpack_require__(136)),Spoken=function(){function e(){_classCallCheck(this,e),this.langs=[],this.langs.push(spoken_1.default.default),this.modules=new modules_1.default(this.langs)}return _createClass(e,[{key:"exposeArgs",value:function(e){var n,t=e.split(" "),a=[],r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,c=/^{(\S*):(\S*)}$/gi.exec(i);a.push([c?"{".concat(c[2],"}"):i,c?c[1]:null])}}catch(o){r.e(o)}finally{r.f()}return a}},{key:"phraseToRegex",value:function(e){return e=(e=this.exposeArgs(e).map((function(e){return e[0]})).join(" ")).replace(/{any}/gi,"(.*)").replace(/{term}/gi,"(\\S+)").replace(/{numeral}/gi,"(\\d+)").replace(/{(\S*)}/gi,"($1)")+"$",new RegExp(e,"gi")}},{key:"matchPhrase",value:function(e,n){var t=this;console.log("[Spoken.matchPhrase] Looking for a match for: "+e);var a=this.findCommand((function(a){var r=a.phrases[n].find((function(n){return t.phraseToRegex(n).exec(e)}));if(r){var i=function(){var n=t.phraseToRegex(r).exec(e);if(!n)return{v:!1};for(var a={},i=t.exposeArgs(r).filter((function(e){return!!e[1]})),c=function(e){if(0===e)a.phrase=n[e];else{var t=_slicedToArray(i[e-1],2),r=t[0],c=t[1],o=/{((\S+\|)+\S*\w)}/gi.exec(r);a[c]=o?o[1].split("|").findIndex((function(t){return t===n[e]})):n[e]}},o=0;o<n.length;o++)c(o);return{v:a}}();if("object"===typeof i)return i.v}return!1}));return a?console.log("[Spoken.matchPhrase] Match found at: "+JSON.stringify(a.getCommandArgs())):console.log("[Spoken.matchPhrase] Match not found"),a}},{key:"matchId",value:function(e){return this.findCommand((function(n){return n.id===e}))}},{key:"findCommand",value:function(e){var n,t,a,r,i,c=_createForOfIteratorHelper(this.langs);try{for(c.s();!(i=c.n()).done;){var o=i.value;for(var s in o.categories||{}){var l=null===(r=null===(a=null===(t=null===(n=o.categories)||void 0===n?void 0:n[s])||void 0===t?void 0:t.commands)||void 0===a?void 0:a.find)||void 0===r?void 0:r.call(a,e);if(l)return new Command(l,e(l))}}}catch(u){c.e(u)}finally{c.f()}return null}}]),e}(),Command=function(){function Command(e,n){_classCallCheck(this,Command),this.command=e,this.commandArgs=n}return _createClass(Command,[{key:"getId",value:function(){return this.command.id}},{key:"getDesc",value:function(){return this.getDesc()}},{key:"getCommandArgs",value:function(){return this.commandArgs}},{key:"getPhrases",value:function(e){return void 0==e?this.command.phrases:this.command.phrases[e]}},{key:"getImpl",value:function(){return this.command.impl}},{key:"makeFunction",value:function makeFunction(){return eval("(() => ".concat(this.getImpl(),")()"))}}]),Command}();exports.default=new Spoken},85:function(e,n){},87:function(e,n){},89:function(e,n){},90:function(e,n){},91:function(e,n){},92:function(e,n){}},[[141,1,2]]]);
//# sourceMappingURL=main.de83721d.chunk.js.map